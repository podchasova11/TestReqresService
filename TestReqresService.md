# TestReqresService


## Построение минимального микросервиса с FastApi и тесты  



### Задание:
Разработать микросервис на Python + FastAPI, можно использовать ChatGPT / autotests.ai (для аппрува учетки отпишите в чат потока).



1. Разработать несколько API-автотестов на https://reqres.in (если обучались на основном курсе python - можно взять код автотестов из домашнего задания)

Можно также за основу взять https://github.com/qa-guru/qa_guru_python_9_19



2. Вместо https://reqres.in разработать свой микросервис в стеке Python + FastAPI (допускается также Flask, Django).

Пример - https://github.com/qa-guru/python-advanced-intro, https://github.com/qa-guru/reqres-service

- Автотесты должны также успешно проходить.

- В коде микросервиса не должно быть хардкода.

Например, не должно быть эндпоинтов типа /api/users/2 - правильнее /api/users/{user_id}



3. Данные для ответа пока что можно хранить в коде или в текстовом файле, в следующих занятиях мы перенесем их в базу данных



4*. Желательно оформить README.md - https://school.qa.guru/teach/control/stream/view/id/465999013 (ctrl+F readme) в тренинге есть несколько занятий по оформлению красивой документации.



В качестве ответа нужно приложить ссылку на код в github (как микросервис, так и тесты можно в одном репозитории)


### Объяснение схемы:
 схема используется для валидации объектов, которые должны содержать строго определённые свойства

```json
{
    "$schema": "http://json-schema.org/draft-04/schema#",
    "type": "object",
    "additionalProperties": false,
    "properties": {
        "id": {
            "type": "string"
        },
        "createdAt": {
            "type": "string"
        },
        "job": {
            "type": "string"
        },
        "name": {
            "type": "string"
        }
    },
    "required": [
        "id",
        "createdAt",
        "job",
        "name"
    ]
}
```

### Объяснение:

1. **$schema**: Указывает на версию схемы JSON, используемую в этом документе. В данном случае это Draft 04.

2. **type**: Указывает, что объект должен быть типа `object`.

3. **additionalProperties**: Установлено значение `false`, что означает, что объект не может содержать свойства, не указанные в разделе `properties`. Это помогает ограничить объект только теми свойствами, которые определены, и предотвращает добавление лишних данных.

4. **properties**: Определяет свойства, которые могут присутствовать в объекте. В данном случае это:
   - **id**: Обязательное свойство, которое должно быть строкой.
   - **createdAt**: Обязательное свойство, которое должно быть строкой. Обычно это используется для хранения даты и времени создания объекта.
   - **job**: Обязательное свойство, которое должно быть строкой, представляющее работу или должность пользователя.
   - **name**: Обязательное свойство, которое также должно быть строкой, представляющее имя пользователя.

5. **required**: В этом массиве перечислены свойства, которые обязательно должны присутствовать в объекте. В данном случае все четыре свойства (`id`, `createdAt`, `job`, `name`) должны быть определены.

### Резюме

Эта схема используется для валидации объектов, которые должны содержать строго определённые свойства (id, createdAt, job, name), все из которых являются строками. Нельзя добавлять дополнительные свойства, что обеспечивает строгость данных. 


# Проект: Построение минимального микросервиса с FastApi и тесты

## Описание проекта

Данный проект представляет собой микросервис, реализованный на **FastAPI**, который предоставляет API для управления пользователями. В проекте реализованы основные CRUD-операции, поддерживается пагинация, а также включены тесты для проверки работоспособности сервиса.

## Установка и запуск

### 1. Клонирование репозитория

```bash
git clone <URL_РЕПОЗИТОРИЯ>
cd project
```

### 2. Установка зависимостей

Рекомендуется создать виртуальное окружение перед установкой зависимостей:

```bash
python -m venv venv
source venv/bin/activate  # Для Linux/macOS
venv\Scripts\activate     # Для Windows
```

Далее установить зависимости:

```bash
pip install -r requirements.txt
```

### 3. Настройка переменных окружения

Создайте файл **.env** на основе **.env.example** и укажите:

```
APP_URL=http://127.0.0.1:8002
HOST=127.0.0.1
PORT=8002
```

### 4. Запуск сервиса

```bash
uvicorn main:app --host 0.0.0.0 --port 8002 --reload
```

## API эндпоинты


| Метод | URL               | Описание                                                                   |
| ---------- | ----------------- | ---------------------------------------------------------------------------------- |
| `GET`      | `/status`         | Проверка доступности сервиса                             |
| `GET`      | `/api/users/`     | Получение списка пользователей с пагинацией |
| `POST`     | `/api/users/`     | Добавление нового пользователя                         |
| `GET`      | `/api/users/{id}` | Получение информации о пользователе                |
| `PUT`      | `/api/users/{id}` | Обновление данных пользователя                         |
| `DELETE`   | `/api/users/{id}` | Удаление пользователя                                          |

## Запуск тестов

### 1. Запуск всех тестов

```bash
pytest tests/
```

### 2. Запуск отдельных групп тестов

#### Тесты API

```bash
pytest tests/test_api.py
```

#### Тесты пагинации

```bash
pytest tests/test_pagination.py
```

#### Smoke-тесты (проверка доступности сервиса)

```bash
pytest tests/test_smoke.py
```

## Дополнительная информация

* В проекте используются **pytest** для тестирования, **requests** для взаимодействия с API и **FastAPI** как основной фреймворк.
* В файле **conftest.py** определены фикстуры для работы с API и тестами.
* В **test\_smoke.py** добавлены дополнительные проверки на доступность сервиса, включая проверку открытия порта.

## Контакты

Если у вас есть вопросы или предложения, создавайте issue в репозитории!



